import{i as rt,f as it,h as Te,j as ot,s as Xe,n as F,r as st,o as at,b as ct}from"../chunks/scheduler.FBjjn5oP.js";import{p as lt,t as Fe,b as _t,d as We,S as Ze,i as et,g as p,s as x,m as ne,h as m,j as O,y as te,f as D,c as P,n as re,k as g,a as He,x as l,z as ae,A as j,o as Ue,B as Ne,e as $e,r as ut,u as ft,v as dt,w as bt}from"../chunks/index.WpgxGuRT.js";const gt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function ht(t,e){const n=e.token={};function r(i,o,b,h){if(e.token!==n)return;e.resolved=h;let c=e.ctx;b!==void 0&&(c=c.slice(),c[b]=h);const u=i&&(e.current=i)(c);let z=!1;e.block&&(e.blocks?e.blocks.forEach((N,W)=>{W!==o&&N&&(lt(),Fe(N,1,1,()=>{e.blocks[W]===N&&(e.blocks[W]=null)}),_t())}):e.block.d(1),u.c(),We(u,1),u.m(e.mount(),e.anchor),z=!0),e.block=u,e.blocks&&(e.blocks[o]=u),z&&ot()}if(rt(t)){const i=it();if(t.then(o=>{Te(i),r(e.then,1,e.value,o),Te(null)},o=>{if(Te(i),r(e.catch,2,e.error,o),Te(null),!e.hasCatch)throw o}),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}}let f;const B=new Array(128).fill(void 0);B.push(void 0,null,!0,!1);function s(t){return B[t]}let pe=B.length;function wt(t){t<132||(B[t]=pe,pe=t)}function ce(t){const e=s(t);return wt(t),e}function Ve(t){return t==null}let ge=null;function pt(){return(ge===null||ge.byteLength===0)&&(ge=new Float64Array(f.memory.buffer)),ge}let he=null;function K(){return(he===null||he.byteLength===0)&&(he=new Int32Array(f.memory.buffer)),he}function _(t){pe===B.length&&B.push(B.length+1);const e=pe;return pe=B[e],B[e]=t,e}const tt=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&tt.decode();let we=null;function Ee(){return(we===null||we.byteLength===0)&&(we=new Uint8Array(f.memory.buffer)),we}function be(t,e){return t=t>>>0,tt.decode(Ee().subarray(t,t+e))}let le=0;const xe=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},mt=typeof xe.encodeInto=="function"?function(t,e){return xe.encodeInto(t,e)}:function(t,e){const n=xe.encode(t);return e.set(n),{read:t.length,written:n.length}};function Me(t,e,n){if(n===void 0){const h=xe.encode(t),c=e(h.length,1)>>>0;return Ee().subarray(c,c+h.length).set(h),le=h.length,c}let r=t.length,i=e(r,1)>>>0;const o=Ee();let b=0;for(;b<r;b++){const h=t.charCodeAt(b);if(h>127)break;o[i+b]=h}if(b!==r){b!==0&&(t=t.slice(b)),i=n(i,r,r=b+t.length*3,1)>>>0;const h=Ee().subarray(i+b,i+r),c=mt(t,h);b+=c.written}return le=b,i}function Oe(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const i=t.description;return i==null?"Symbol":`Symbol(${i})`}if(e=="function"){const i=t.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(t)){const i=t.length;let o="[";i>0&&(o+=Oe(t[0]));for(let b=1;b<i;b++)o+=", "+Oe(t[b]);return o+="]",o}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function U(t,e){try{return t.apply(this,e)}catch(n){f.__wbindgen_exn_store(_(n))}}class Pe{static __wrap(e){e=e>>>0;const n=Object.create(Pe.prototype);return n.__wbg_ptr=e,n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();f.__wbg_engine_free(e)}static create(e){const n=f.engine_create(_(e));return Pe.__wrap(n)}run_iteration(e){const n=f.engine_run_iteration(this.__wbg_ptr,e);return ce(n)}add_circle(e,n,r){f.engine_add_circle(this.__wbg_ptr,e,n,r)}add_polygon(e){f.engine_add_polygon(this.__wbg_ptr,_(e))}erase_at(e,n){f.engine_erase_at(this.__wbg_ptr,e,n)}add_hinge(e,n){f.engine_add_hinge(this.__wbg_ptr,e,n)}add_rigid(e,n){f.engine_add_rigid(this.__wbg_ptr,e,n)}set_gravity_multipier(e){f.engine_set_gravity_multipier(this.__wbg_ptr,e)}set_restitution_multipier(e){f.engine_set_restitution_multipier(this.__wbg_ptr,e)}set_friction_multipier(e){f.engine_set_friction_multipier(this.__wbg_ptr,e)}set_static_friction(e){f.engine_set_static_friction(this.__wbg_ptr,e)}set_dynamic_friction(e){f.engine_set_dynamic_friction(this.__wbg_ptr,e)}}async function yt(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function vt(){const t={};return t.wbg={},t.wbg.__wbindgen_object_drop_ref=function(e){ce(e)},t.wbg.__wbindgen_is_undefined=function(e){return s(e)===void 0},t.wbg.__wbindgen_in=function(e,n){return s(e)in s(n)},t.wbg.__wbindgen_number_get=function(e,n){const r=s(n),i=typeof r=="number"?r:void 0;pt()[e/8+1]=Ve(i)?0:i,K()[e/4+0]=!Ve(i)},t.wbg.__wbindgen_boolean_get=function(e){const n=s(e);return typeof n=="boolean"?n?1:0:2},t.wbg.__wbindgen_is_object=function(e){const n=s(e);return typeof n=="object"&&n!==null},t.wbg.__wbindgen_object_clone_ref=function(e){const n=s(e);return _(n)},t.wbg.__wbindgen_error_new=function(e,n){const r=new Error(be(e,n));return _(r)},t.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return _(e)},t.wbg.__wbg_stack_658279fe44541cf6=function(e,n){const r=s(n).stack,i=Me(r,f.__wbindgen_malloc,f.__wbindgen_realloc),o=le;K()[e/4+1]=o,K()[e/4+0]=i},t.wbg.__wbg_error_f851667af71bcfc6=function(e,n){let r,i;try{r=e,i=n,console.error(be(e,n))}finally{f.__wbindgen_free(r,i,1)}},t.wbg.__wbg_crypto_d05b68a3572bb8ca=function(e){const n=s(e).crypto;return _(n)},t.wbg.__wbg_process_b02b3570280d0366=function(e){const n=s(e).process;return _(n)},t.wbg.__wbg_versions_c1cb42213cedf0f5=function(e){const n=s(e).versions;return _(n)},t.wbg.__wbg_node_43b1089f407e4ec2=function(e){const n=s(e).node;return _(n)},t.wbg.__wbindgen_is_string=function(e){return typeof s(e)=="string"},t.wbg.__wbg_msCrypto_10fc94afee92bd76=function(e){const n=s(e).msCrypto;return _(n)},t.wbg.__wbg_require_9a7e0f667ead4995=function(){return U(function(){const e=module.require;return _(e)},arguments)},t.wbg.__wbindgen_is_function=function(e){return typeof s(e)=="function"},t.wbg.__wbindgen_string_new=function(e,n){const r=be(e,n);return _(r)},t.wbg.__wbg_getRandomValues_7e42b4fb8779dc6d=function(){return U(function(e,n){s(e).getRandomValues(s(n))},arguments)},t.wbg.__wbg_randomFillSync_b70ccbdf4926a99d=function(){return U(function(e,n){s(e).randomFillSync(ce(n))},arguments)},t.wbg.__wbindgen_jsval_loose_eq=function(e,n){return s(e)==s(n)},t.wbg.__wbindgen_string_get=function(e,n){const r=s(n),i=typeof r=="string"?r:void 0;var o=Ve(i)?0:Me(i,f.__wbindgen_malloc,f.__wbindgen_realloc),b=le;K()[e/4+1]=b,K()[e/4+0]=o},t.wbg.__wbg_String_88810dfeb4021902=function(e,n){const r=String(s(n)),i=Me(r,f.__wbindgen_malloc,f.__wbindgen_realloc),o=le;K()[e/4+1]=o,K()[e/4+0]=i},t.wbg.__wbindgen_number_new=function(e){return _(e)},t.wbg.__wbg_getwithrefkey_5e6d9547403deab8=function(e,n){const r=s(e)[s(n)];return _(r)},t.wbg.__wbg_set_841ac57cff3d672b=function(e,n,r){s(e)[ce(n)]=ce(r)},t.wbg.__wbg_get_f01601b5a68d10e3=function(e,n){const r=s(e)[n>>>0];return _(r)},t.wbg.__wbg_length_1009b1af0c481d7b=function(e){return s(e).length},t.wbg.__wbg_new_ffc6d4d085022169=function(){const e=new Array;return _(e)},t.wbg.__wbg_newnoargs_c62ea9419c21fbac=function(e,n){const r=new Function(be(e,n));return _(r)},t.wbg.__wbg_next_9b877f231f476d01=function(e){const n=s(e).next;return _(n)},t.wbg.__wbg_next_6529ee0cca8d57ed=function(){return U(function(e){const n=s(e).next();return _(n)},arguments)},t.wbg.__wbg_done_5fe336b092d60cf2=function(e){return s(e).done},t.wbg.__wbg_value_0c248a78fdc8e19f=function(e){const n=s(e).value;return _(n)},t.wbg.__wbg_iterator_db7ca081358d4fb2=function(){return _(Symbol.iterator)},t.wbg.__wbg_get_7b48513de5dc5ea4=function(){return U(function(e,n){const r=Reflect.get(s(e),s(n));return _(r)},arguments)},t.wbg.__wbg_call_90c26b09837aba1c=function(){return U(function(e,n){const r=s(e).call(s(n));return _(r)},arguments)},t.wbg.__wbg_new_9fb8d994e1c0aaac=function(){const e=new Object;return _(e)},t.wbg.__wbg_self_f0e34d89f33b99fd=function(){return U(function(){const e=self.self;return _(e)},arguments)},t.wbg.__wbg_window_d3b084224f4774d7=function(){return U(function(){const e=window.window;return _(e)},arguments)},t.wbg.__wbg_globalThis_9caa27ff917c6860=function(){return U(function(){const e=globalThis.globalThis;return _(e)},arguments)},t.wbg.__wbg_global_35dfdd59a4da3e74=function(){return U(function(){const e=global.global;return _(e)},arguments)},t.wbg.__wbg_set_f2740edb12e318cd=function(e,n,r){s(e)[n>>>0]=ce(r)},t.wbg.__wbg_isArray_74fb723e24f76012=function(e){return Array.isArray(s(e))},t.wbg.__wbg_instanceof_ArrayBuffer_e7d53d51371448e2=function(e){let n;try{n=s(e)instanceof ArrayBuffer}catch{n=!1}return n},t.wbg.__wbg_call_5da1969d7cd31ccd=function(){return U(function(e,n,r){const i=s(e).call(s(n),s(r));return _(i)},arguments)},t.wbg.__wbg_buffer_a448f833075b71ba=function(e){const n=s(e).buffer;return _(n)},t.wbg.__wbg_newwithbyteoffsetandlength_d0482f893617af71=function(e,n,r){const i=new Uint8Array(s(e),n>>>0,r>>>0);return _(i)},t.wbg.__wbg_new_8f67e318f15d7254=function(e){const n=new Uint8Array(s(e));return _(n)},t.wbg.__wbg_set_2357bf09366ee480=function(e,n,r){s(e).set(s(n),r>>>0)},t.wbg.__wbg_length_1d25fa9e4ac21ce7=function(e){return s(e).length},t.wbg.__wbg_instanceof_Uint8Array_bced6f43aed8c1aa=function(e){let n;try{n=s(e)instanceof Uint8Array}catch{n=!1}return n},t.wbg.__wbg_newwithlength_6c2df9e2f3028c43=function(e){const n=new Uint8Array(e>>>0);return _(n)},t.wbg.__wbg_subarray_2e940e41c0f5a1d9=function(e,n,r){const i=s(e).subarray(n>>>0,r>>>0);return _(i)},t.wbg.__wbindgen_debug_string=function(e,n){const r=Oe(s(n)),i=Me(r,f.__wbindgen_malloc,f.__wbindgen_realloc),o=le;K()[e/4+1]=o,K()[e/4+0]=i},t.wbg.__wbindgen_throw=function(e,n){throw new Error(be(e,n))},t.wbg.__wbindgen_memory=function(){const e=f.memory;return _(e)},t}function kt(t,e){return f=t.exports,nt.__wbindgen_wasm_module=e,ge=null,he=null,we=null,f}async function nt(t){if(f!==void 0)return f;typeof t>"u"&&(t="assets/physics_engine_bg.wasm");const e=vt();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:r}=await yt(await t,e);return kt(n,r)}const{window:Ye}=gt;function Tt(t){let e,n,r,i,o,b="",h,c,u,z,N,W,T,J,R,Y='<span class="mr-auto">-10</span> <span>10</span>',G,k,_e,ie,ue,S,fe,H,me='<span class="mr-auto">0</span> <span>10</span>',de,d,y,M,L,a,Q,q,V='<span class="mr-auto">-10</span> <span>10</span>',A,v,I,X,oe,qe="static friction",Se,$,Z,Ie,se,Ke="dynamic friction",Ce,ee,Be=`Controls: To draw a polygon draw an outline on the canvas holding the left mouse button. To
				draw a circle just place the mouse where you want to create the circle and hold the left
				mouse button. When the radius reaches the desired size just release the mouse button. You
				can also connect two shapes via a hinge. In order to do so, press the &#39;d&#39; button and left
				click on the first shape. This will create a hinge. To connect another shape to it you have
				to draw another shape overlapping the created hinge. To delete a shape press &#39;a&#39; and left
				click it.
				<br/> <br/>

				The physics engine used for the simulation on the right is our toy physics engine written in
				Rust and compiled to WebAssembly. The engine uses two main algorithms to compute the
				collisions. First, the
				<a target="_blank" href="https://en.wikipedia.org/wiki/Gilbert%E2%80%93Johnson%E2%80%93Keerthi_distance_algorithm" class="svelte-5rd8a1">GJK</a>
				algorithm helps determine werther two shapes are in contact. If they are, the
				<a target="_blank" href="https://dyn4j.org/2010/05/epa-expanding-polytope-algorithm/" class="svelte-5rd8a1">EPA</a>
				algorithm picks up at the collision vector, and finds the minimum penetration vector. Based on
				that, an
				<a target="_blank" href="https://en.wikipedia.org/wiki/Collision_response#Impulse-based_contact_model" class="svelte-5rd8a1">impulse</a>
				is calculated, which is then used to apply momentum to the relevant shapes at each time tick.`,je,ze;return{c(){e=p("div"),n=p("div"),r=p("div"),i=p("div"),o=p("canvas"),o.innerHTML=b,h=x(),c=p("div"),u=p("span"),z=ne("gravity "),N=ne(t[0]),W=x(),T=p("input"),J=x(),R=p("div"),R.innerHTML=Y,G=x(),k=p("span"),_e=ne("friction "),ie=ne(t[1]),ue=x(),S=p("input"),fe=x(),H=p("div"),H.innerHTML=me,de=x(),d=p("span"),y=ne("restitution "),M=ne(t[2]),L=x(),a=p("input"),Q=x(),q=p("div"),q.innerHTML=V,A=x(),v=p("div"),I=p("input"),X=x(),oe=p("span"),oe.textContent=qe,Se=x(),$=p("div"),Z=p("input"),Ie=x(),se=p("span"),se.textContent=Ke,Ce=x(),ee=p("div"),ee.innerHTML=Be,this.h()},l(E){e=m(E,"DIV",{class:!0});var C=O(e);n=m(C,"DIV",{class:!0});var ye=O(n);r=m(ye,"DIV",{class:!0});var Je=O(r);i=m(Je,"DIV",{class:!0});var Ge=O(i);o=m(Ge,"CANVAS",{class:!0,"data-svelte-h":!0}),te(o)!=="svelte-mwydlm"&&(o.innerHTML=b),Ge.forEach(D),Je.forEach(D),h=P(ye),c=m(ye,"DIV",{class:!0});var w=O(c);u=m(w,"SPAN",{});var De=O(u);z=re(De,"gravity "),N=re(De,t[0]),De.forEach(D),W=P(w),T=m(w,"INPUT",{type:!0,min:!0,max:!0,step:!0}),J=P(w),R=m(w,"DIV",{class:!0,"data-svelte-h":!0}),te(R)!=="svelte-1dhvvbm"&&(R.innerHTML=Y),G=P(w),k=m(w,"SPAN",{class:!0});var Re=O(k);_e=re(Re,"friction "),ie=re(Re,t[1]),Re.forEach(D),ue=P(w),S=m(w,"INPUT",{type:!0,min:!0,max:!0,step:!0}),fe=P(w),H=m(w,"DIV",{class:!0,"data-svelte-h":!0}),te(H)!=="svelte-f3oit8"&&(H.innerHTML=me),de=P(w),d=m(w,"SPAN",{class:!0});var Le=O(d);y=re(Le,"restitution "),M=re(Le,t[2]),Le.forEach(D),L=P(w),a=m(w,"INPUT",{type:!0,min:!0,max:!0,step:!0}),Q=P(w),q=m(w,"DIV",{class:!0,"data-svelte-h":!0}),te(q)!=="svelte-1dhvvbm"&&(q.innerHTML=V),A=P(w),v=m(w,"DIV",{class:!0});var ve=O(v);I=m(ve,"INPUT",{type:!0}),X=P(ve),oe=m(ve,"SPAN",{"data-svelte-h":!0}),te(oe)!=="svelte-4w3dmm"&&(oe.textContent=qe),ve.forEach(D),Se=P(w),$=m(w,"DIV",{class:!0});var ke=O($);Z=m(ke,"INPUT",{type:!0}),Ie=P(ke),se=m(ke,"SPAN",{"data-svelte-h":!0}),te(se)!=="svelte-1f9cjqb"&&(se.textContent=Ke),ke.forEach(D),Ce=P(w),ee=m(w,"DIV",{class:!0,"data-svelte-h":!0}),te(ee)!=="svelte-m6rmnj"&&(ee.innerHTML=Be),w.forEach(D),ye.forEach(D),C.forEach(D),this.h()},h(){g(o,"class","w-full h-full touch-none"),g(i,"class","overflow-hidden aspect-square max-h-full mx-auto border border-gray-400"),g(r,"class","grow-[2] basis-0"),g(T,"type","range"),g(T,"min","-10"),g(T,"max","10"),g(T,"step","0.1"),g(R,"class","flex"),g(k,"class","pt-6"),g(S,"type","range"),g(S,"min","0"),g(S,"max","10"),g(S,"step","0.1"),g(H,"class","flex"),g(d,"class","pt-6"),g(a,"type","range"),g(a,"min","-10"),g(a,"max","10"),g(a,"step","0.1"),g(q,"class","flex"),g(I,"type","checkbox"),g(v,"class","pt-4"),g(Z,"type","checkbox"),g($,"class","pt-4"),g(ee,"class","mt-4 pt-4 border-t border-gray-400 text-justify"),g(c,"class","grow basis-0 flex flex-col"),g(n,"class","grow min-h-0 flex gap-8 flex-col md:flex-row"),g(e,"class","h-screen w-screen p-8 flex flex-col")},m(E,C){He(E,e,C),l(e,n),l(n,r),l(r,i),l(i,o),t[13](o),l(n,h),l(n,c),l(c,u),l(u,z),l(u,N),l(c,W),l(c,T),ae(T,t[0]),l(c,J),l(c,R),l(c,G),l(c,k),l(k,_e),l(k,ie),l(c,ue),l(c,S),ae(S,t[1]),l(c,fe),l(c,H),l(c,de),l(c,d),l(d,y),l(d,M),l(c,L),l(c,a),ae(a,t[2]),l(c,Q),l(c,q),l(c,A),l(c,v),l(v,I),I.checked=t[4],l(v,X),l(v,oe),l(c,Se),l(c,$),l($,Z),Z.checked=t[3],l($,Ie),l($,se),l(c,Ce),l(c,ee),je||(ze=[j(Ye,"keydown",t[9]),j(Ye,"keyup",t[10]),j(o,"pointerdown",t[6]),j(o,"pointerup",t[7]),j(o,"pointermove",t[8]),j(T,"change",t[14]),j(T,"input",t[14]),j(S,"change",t[15]),j(S,"input",t[15]),j(a,"change",t[16]),j(a,"input",t[16]),j(I,"change",t[17]),j(Z,"change",t[18])],je=!0)},p(E,[C]){C&1&&Ue(N,E[0]),C&1&&ae(T,E[0]),C&2&&Ue(ie,E[1]),C&2&&ae(S,E[1]),C&4&&Ue(M,E[2]),C&4&&ae(a,E[2]),C&16&&(I.checked=E[4]),C&8&&(Z.checked=E[3])},i:F,o:F,d(E){E&&D(e),t[13](null),je=!1,st(ze)}}}function Ae(t,e,n){e.forEach(r=>{t.fillStyle=n,t.beginPath(),t.arc(...r,7,0,2*Math.PI),t.fill(),t.stroke()})}function Qe(t){return(+new Date-+t)/20}function Mt(t,e,n){let{PhysicsEngine:r}=e,i,o,b=0,h=1;at(()=>{let d=!1;n(12,i=r.create({initial_ball_position:[0,0],circles:[{is_bindable:!1,is_static:!0,shape:{center:[100,900],radius:10}}],flags_positions:[],polygons:[{is_bindable:!1,is_static:!0,shape:[[100,1030],[100,1e3],[1600,1005],[1600,1035]]}]}));let y=new ResizeObserver(()=>{let L=window.devicePixelRatio,a=o.getBoundingClientRect();n(5,o.width=Math.round(L*a.right)-Math.round(L*a.left),o),n(5,o.height=Math.round(L*a.bottom)-Math.round(L*a.top),o);let Q=o.getContext("2d");h=a.width/600,Q.scale(h,h)});y.observe(o);let M=L=>{if(d)return;let a=o.getContext("2d"),{width:Q,height:q}=o,V=i.run_iteration((L-b)*1e3);switch(b=L,a.clearRect(0,0,Q/h,q/h),V.polygons.forEach(A=>{let v=A.color;a.fillStyle=`rgb(${Math.floor(v[0]*256)} ${Math.floor(v[1]*256)} ${Math.floor(v[2]*256)})`,a.beginPath();let I=A.shape.vertices[0];a.moveTo(...I),A.shape.vertices.slice(1).forEach(X=>{a.lineTo(...X)}),a.closePath(),a.fill(),a.stroke()}),V.circles.forEach(A=>{let v=A.color;a.fillStyle=`rgb(${Math.floor(v[0]*256)} ${Math.floor(v[1]*256)} ${Math.floor(v[2]*256)})`,a.beginPath(),a.arc(...A.shape.center,A.shape.radius,0,2*Math.PI),a.fill(),a.stroke()}),u.kind){case 0:{a.beginPath(),a.arc(...u.center,Qe(u.startTime),0,2*Math.PI),a.stroke();break}case 1:{a.beginPath();const[A,v]=u.path[0];a.moveTo(A,v);for(const[I,X]of u.path.slice(1))a.lineTo(I,X);a.stroke();break}}V.flags.forEach(A=>{a.fillStyle="black",a.beginPath();let v=A.vertices[0];a.moveTo(...v),A.vertices.slice(1).forEach(I=>{a.lineTo(...I)}),a.closePath(),a.fill(),a.stroke()}),Ae(a,V.rigid_bindings,"red"),Ae(a,V.unbound_hinges,"orange"),Ae(a,V.hinges,"blue"),Ae(a,V.unbound_hinges,"green"),requestAnimationFrame(M)};return requestAnimationFrame(M),()=>{i.free(),d=!0,y.disconnect()}});function c(d){let y=o.getBoundingClientRect();return{x:(Math.round(d.x*devicePixelRatio)-Math.round(y.left*devicePixelRatio))/h,y:(Math.round(d.y*devicePixelRatio)-Math.round(y.top*devicePixelRatio))/h}}let u={kind:3};function z(d){let{x:y,y:M}=c(d);switch(k){case 0:{i.erase_at(y,M);break}case 1:{i.add_rigid(y,M);break}case 2:{i.add_hinge(y,M);break}case 3:{u={kind:2,circleTriggerTimer:setTimeout(()=>{u={kind:0,center:[y,M],startTime:new Date}},400)};break}}}function N(d){switch(u.kind){case 0:{let y=Qe(u.startTime);i.add_circle(u.center[0],u.center[1],y),u={kind:3};break}case 1:{u.path.length>3&&i.add_polygon({vertices:u.path}),u={kind:3};break}case 2:{clearTimeout(u.circleTriggerTimer),u={kind:3};break}}}function W(d){switch(u.kind){case 0:break;case 1:{let{x:y,y:M}=c(d);u.path.push([y,M]);break}case 2:{clearTimeout(u.circleTriggerTimer);let{x:y,y:M}=c(d);u={kind:1,path:[[y,M]]};break}}}let T=1,J=1,R=1,Y=!0,G=!0,k=3;function _e(d){switch(d.code){case"KeyD":{k=2;break}case"KeyA":{k=0;break}case"KeyS":{k=1;break}}}function ie(d){switch(d.code){case"KeyD":{k==2&&(k=3);break}case"KeyA":{k==0&&(k=3);break}case"KeyS":{k==1&&(k=3);break}}}function ue(d){ct[d?"unshift":"push"](()=>{o=d,n(5,o)})}function S(){T=Ne(this.value),n(0,T)}function fe(){J=Ne(this.value),n(1,J)}function H(){R=Ne(this.value),n(2,R)}function me(){G=this.checked,n(4,G)}function de(){Y=this.checked,n(3,Y)}return t.$$set=d=>{"PhysicsEngine"in d&&n(11,r=d.PhysicsEngine)},t.$$.update=()=>{t.$$.dirty&4097&&i?.set_gravity_multipier(T),t.$$.dirty&4098&&i?.set_friction_multipier(J),t.$$.dirty&4100&&i?.set_restitution_multipier(R),t.$$.dirty&4104&&i?.set_dynamic_friction(Y),t.$$.dirty&4112&&i?.set_static_friction(G)},[T,J,R,Y,G,o,z,N,W,_e,ie,r,i,ue,S,fe,H,me,de]}class At extends Ze{constructor(e){super(),et(this,e,Mt,Tt,Xe,{PhysicsEngine:11})}}function Et(t){return{c:F,l:F,m:F,i:F,o:F,d:F}}function xt(t){let e,n;return e=new At({props:{PhysicsEngine:Pe}}),{c(){ut(e.$$.fragment)},l(r){ft(e.$$.fragment,r)},m(r,i){dt(e,r,i),n=!0},i(r){n||(We(e.$$.fragment,r),n=!0)},o(r){Fe(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}function Pt(t){let e;return{c(){e=ne("Loading")},l(n){e=re(n,"Loading")},m(n,r){He(n,e,r)},i:F,o:F,d(n){n&&D(e)}}}function St(t){let e,n,r={ctx:t,current:null,token:null,hasCatch:!1,pending:Pt,then:xt,catch:Et,blocks:[,,,]};return ht(nt(),r),{c(){e=$e(),r.block.c()},l(i){e=$e(),r.block.l(i)},m(i,o){He(i,e,o),r.block.m(i,r.anchor=o),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(i,[o]){t=i},i(i){n||(We(r.block),n=!0)},o(i){for(let o=0;o<3;o+=1){const b=r.blocks[o];Fe(b)}n=!1},d(i){i&&D(e),r.block.d(i),r.token=null,r=null}}}class jt extends Ze{constructor(e){super(),et(this,e,null,St,Xe,{})}}export{jt as component};
