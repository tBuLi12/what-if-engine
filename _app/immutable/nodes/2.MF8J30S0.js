import{i as rt,f as it,h as ke,j as ot,s as Xe,n as H,r as st,o as at,b as ct}from"../chunks/scheduler.FBjjn5oP.js";import{p as lt,t as Fe,b as _t,d as qe,S as Ze,i as et,g as w,s as S,m as te,h as p,j as W,y as ee,f as L,c as I,n as ne,k as d,a as We,x as c,z as se,A as R,o as Ue,B as Ne,e as $e,r as ut,u as ft,v as dt,w as bt}from"../chunks/index.WpgxGuRT.js";const gt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function ht(t,e){const n=e.token={};function r(i,s,f,m){if(e.token!==n)return;e.resolved=m;let o=e.ctx;f!==void 0&&(o=o.slice(),o[f]=m);const A=i&&(e.current=i)(o);let G=!1;e.block&&(e.blocks?e.blocks.forEach((q,U)=>{U!==s&&q&&(lt(),Fe(q,1,1,()=>{e.blocks[U]===q&&(e.blocks[U]=null)}),_t())}):e.block.d(1),A.c(),qe(A,1),A.m(e.mount(),e.anchor),G=!0),e.block=A,e.blocks&&(e.blocks[s]=A),G&&ot()}if(rt(t)){const i=it();if(t.then(s=>{ke(i),r(e.then,1,e.value,s),ke(null)},s=>{if(ke(i),r(e.catch,2,e.error,s),ke(null),!e.hasCatch)throw s}),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}}let u;const J=new Array(128).fill(void 0);J.push(void 0,null,!0,!1);function a(t){return J[t]}let we=J.length;function wt(t){t<132||(J[t]=we,we=t)}function ae(t){const e=a(t);return wt(t),e}function Ve(t){return t==null}let be=null;function pt(){return(be===null||be.byteLength===0)&&(be=new Float64Array(u.memory.buffer)),be}let ge=null;function z(){return(ge===null||ge.byteLength===0)&&(ge=new Int32Array(u.memory.buffer)),ge}function _(t){we===J.length&&J.push(J.length+1);const e=we;return we=J[e],J[e]=t,e}const tt=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&tt.decode();let he=null;function Ae(){return(he===null||he.byteLength===0)&&(he=new Uint8Array(u.memory.buffer)),he}function de(t,e){return t=t>>>0,tt.decode(Ae().subarray(t,t+e))}let ce=0;const Ee=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},mt=typeof Ee.encodeInto=="function"?function(t,e){return Ee.encodeInto(t,e)}:function(t,e){const n=Ee.encode(t);return e.set(n),{read:t.length,written:n.length}};function Te(t,e,n){if(n===void 0){const m=Ee.encode(t),o=e(m.length,1)>>>0;return Ae().subarray(o,o+m.length).set(m),ce=m.length,o}let r=t.length,i=e(r,1)>>>0;const s=Ae();let f=0;for(;f<r;f++){const m=t.charCodeAt(f);if(m>127)break;s[i+f]=m}if(f!==r){f!==0&&(t=t.slice(f)),i=n(i,r,r=f+t.length*3,1)>>>0;const m=Ae().subarray(i+f,i+r),o=mt(t,m);f+=o.written}return ce=f,i}function Oe(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const i=t.description;return i==null?"Symbol":`Symbol(${i})`}if(e=="function"){const i=t.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(t)){const i=t.length;let s="[";i>0&&(s+=Oe(t[0]));for(let f=1;f<i;f++)s+=", "+Oe(t[f]);return s+="]",s}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function F(t,e){try{return t.apply(this,e)}catch(n){u.__wbindgen_exn_store(_(n))}}class Pe{static __wrap(e){e=e>>>0;const n=Object.create(Pe.prototype);return n.__wbg_ptr=e,n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();u.__wbg_engine_free(e)}static create(e){const n=u.engine_create(_(e));return Pe.__wrap(n)}run_iteration(e){const n=u.engine_run_iteration(this.__wbg_ptr,e);return ae(n)}add_circle(e,n,r){u.engine_add_circle(this.__wbg_ptr,e,n,r)}add_polygon(e){u.engine_add_polygon(this.__wbg_ptr,_(e))}erase_at(e,n){u.engine_erase_at(this.__wbg_ptr,e,n)}add_hinge(e,n){u.engine_add_hinge(this.__wbg_ptr,e,n)}add_rigid(e,n){u.engine_add_rigid(this.__wbg_ptr,e,n)}set_gravity_multipier(e){u.engine_set_gravity_multipier(this.__wbg_ptr,e)}set_restitution_multipier(e){u.engine_set_restitution_multipier(this.__wbg_ptr,e)}set_friction_multipier(e){u.engine_set_friction_multipier(this.__wbg_ptr,e)}set_static_friction(e){u.engine_set_static_friction(this.__wbg_ptr,e)}set_dynamic_friction(e){u.engine_set_dynamic_friction(this.__wbg_ptr,e)}}async function yt(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function vt(){const t={};return t.wbg={},t.wbg.__wbindgen_object_drop_ref=function(e){ae(e)},t.wbg.__wbindgen_is_undefined=function(e){return a(e)===void 0},t.wbg.__wbindgen_in=function(e,n){return a(e)in a(n)},t.wbg.__wbindgen_number_get=function(e,n){const r=a(n),i=typeof r=="number"?r:void 0;pt()[e/8+1]=Ve(i)?0:i,z()[e/4+0]=!Ve(i)},t.wbg.__wbindgen_boolean_get=function(e){const n=a(e);return typeof n=="boolean"?n?1:0:2},t.wbg.__wbindgen_is_object=function(e){const n=a(e);return typeof n=="object"&&n!==null},t.wbg.__wbindgen_object_clone_ref=function(e){const n=a(e);return _(n)},t.wbg.__wbindgen_error_new=function(e,n){const r=new Error(de(e,n));return _(r)},t.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return _(e)},t.wbg.__wbg_stack_658279fe44541cf6=function(e,n){const r=a(n).stack,i=Te(r,u.__wbindgen_malloc,u.__wbindgen_realloc),s=ce;z()[e/4+1]=s,z()[e/4+0]=i},t.wbg.__wbg_error_f851667af71bcfc6=function(e,n){let r,i;try{r=e,i=n,console.error(de(e,n))}finally{u.__wbindgen_free(r,i,1)}},t.wbg.__wbg_crypto_d05b68a3572bb8ca=function(e){const n=a(e).crypto;return _(n)},t.wbg.__wbg_process_b02b3570280d0366=function(e){const n=a(e).process;return _(n)},t.wbg.__wbg_versions_c1cb42213cedf0f5=function(e){const n=a(e).versions;return _(n)},t.wbg.__wbg_node_43b1089f407e4ec2=function(e){const n=a(e).node;return _(n)},t.wbg.__wbindgen_is_string=function(e){return typeof a(e)=="string"},t.wbg.__wbg_msCrypto_10fc94afee92bd76=function(e){const n=a(e).msCrypto;return _(n)},t.wbg.__wbg_require_9a7e0f667ead4995=function(){return F(function(){const e=module.require;return _(e)},arguments)},t.wbg.__wbindgen_is_function=function(e){return typeof a(e)=="function"},t.wbg.__wbindgen_string_new=function(e,n){const r=de(e,n);return _(r)},t.wbg.__wbg_getRandomValues_7e42b4fb8779dc6d=function(){return F(function(e,n){a(e).getRandomValues(a(n))},arguments)},t.wbg.__wbg_randomFillSync_b70ccbdf4926a99d=function(){return F(function(e,n){a(e).randomFillSync(ae(n))},arguments)},t.wbg.__wbindgen_jsval_loose_eq=function(e,n){return a(e)==a(n)},t.wbg.__wbindgen_string_get=function(e,n){const r=a(n),i=typeof r=="string"?r:void 0;var s=Ve(i)?0:Te(i,u.__wbindgen_malloc,u.__wbindgen_realloc),f=ce;z()[e/4+1]=f,z()[e/4+0]=s},t.wbg.__wbg_String_88810dfeb4021902=function(e,n){const r=String(a(n)),i=Te(r,u.__wbindgen_malloc,u.__wbindgen_realloc),s=ce;z()[e/4+1]=s,z()[e/4+0]=i},t.wbg.__wbindgen_number_new=function(e){return _(e)},t.wbg.__wbg_getwithrefkey_5e6d9547403deab8=function(e,n){const r=a(e)[a(n)];return _(r)},t.wbg.__wbg_set_841ac57cff3d672b=function(e,n,r){a(e)[ae(n)]=ae(r)},t.wbg.__wbg_get_f01601b5a68d10e3=function(e,n){const r=a(e)[n>>>0];return _(r)},t.wbg.__wbg_length_1009b1af0c481d7b=function(e){return a(e).length},t.wbg.__wbg_new_ffc6d4d085022169=function(){const e=new Array;return _(e)},t.wbg.__wbg_newnoargs_c62ea9419c21fbac=function(e,n){const r=new Function(de(e,n));return _(r)},t.wbg.__wbg_next_9b877f231f476d01=function(e){const n=a(e).next;return _(n)},t.wbg.__wbg_next_6529ee0cca8d57ed=function(){return F(function(e){const n=a(e).next();return _(n)},arguments)},t.wbg.__wbg_done_5fe336b092d60cf2=function(e){return a(e).done},t.wbg.__wbg_value_0c248a78fdc8e19f=function(e){const n=a(e).value;return _(n)},t.wbg.__wbg_iterator_db7ca081358d4fb2=function(){return _(Symbol.iterator)},t.wbg.__wbg_get_7b48513de5dc5ea4=function(){return F(function(e,n){const r=Reflect.get(a(e),a(n));return _(r)},arguments)},t.wbg.__wbg_call_90c26b09837aba1c=function(){return F(function(e,n){const r=a(e).call(a(n));return _(r)},arguments)},t.wbg.__wbg_new_9fb8d994e1c0aaac=function(){const e=new Object;return _(e)},t.wbg.__wbg_self_f0e34d89f33b99fd=function(){return F(function(){const e=self.self;return _(e)},arguments)},t.wbg.__wbg_window_d3b084224f4774d7=function(){return F(function(){const e=window.window;return _(e)},arguments)},t.wbg.__wbg_globalThis_9caa27ff917c6860=function(){return F(function(){const e=globalThis.globalThis;return _(e)},arguments)},t.wbg.__wbg_global_35dfdd59a4da3e74=function(){return F(function(){const e=global.global;return _(e)},arguments)},t.wbg.__wbg_set_f2740edb12e318cd=function(e,n,r){a(e)[n>>>0]=ae(r)},t.wbg.__wbg_isArray_74fb723e24f76012=function(e){return Array.isArray(a(e))},t.wbg.__wbg_instanceof_ArrayBuffer_e7d53d51371448e2=function(e){let n;try{n=a(e)instanceof ArrayBuffer}catch{n=!1}return n},t.wbg.__wbg_call_5da1969d7cd31ccd=function(){return F(function(e,n,r){const i=a(e).call(a(n),a(r));return _(i)},arguments)},t.wbg.__wbg_buffer_a448f833075b71ba=function(e){const n=a(e).buffer;return _(n)},t.wbg.__wbg_newwithbyteoffsetandlength_d0482f893617af71=function(e,n,r){const i=new Uint8Array(a(e),n>>>0,r>>>0);return _(i)},t.wbg.__wbg_new_8f67e318f15d7254=function(e){const n=new Uint8Array(a(e));return _(n)},t.wbg.__wbg_set_2357bf09366ee480=function(e,n,r){a(e).set(a(n),r>>>0)},t.wbg.__wbg_length_1d25fa9e4ac21ce7=function(e){return a(e).length},t.wbg.__wbg_instanceof_Uint8Array_bced6f43aed8c1aa=function(e){let n;try{n=a(e)instanceof Uint8Array}catch{n=!1}return n},t.wbg.__wbg_newwithlength_6c2df9e2f3028c43=function(e){const n=new Uint8Array(e>>>0);return _(n)},t.wbg.__wbg_subarray_2e940e41c0f5a1d9=function(e,n,r){const i=a(e).subarray(n>>>0,r>>>0);return _(i)},t.wbg.__wbindgen_debug_string=function(e,n){const r=Oe(a(n)),i=Te(r,u.__wbindgen_malloc,u.__wbindgen_realloc),s=ce;z()[e/4+1]=s,z()[e/4+0]=i},t.wbg.__wbindgen_throw=function(e,n){throw new Error(de(e,n))},t.wbg.__wbindgen_memory=function(){const e=u.memory;return _(e)},t}function kt(t,e){return u=t.exports,nt.__wbindgen_wasm_module=e,be=null,ge=null,he=null,u}async function nt(t){if(u!==void 0)return u;typeof t>"u"&&(t="assets/physics_engine_bg.wasm");const e=vt();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:r}=await yt(await t,e);return kt(n,r)}const{window:Ye}=gt;function Tt(t){let e,n,r,i,s,f="",m,o,A,G,q,U,y,$,N,Q='<span class="mr-auto">-10</span> <span>10</span>',E,K,le,re,_e,j,ue,B,pe='<span class="mr-auto">0</span> <span>10</span>',b,g,v,V,l,C,fe,k,T='<span class="mr-auto">-10</span> <span>10</span>',M,P,O,xe,ie,He="static friction",Se,Y,X,Ie,oe,Ke="dynamic friction",je,Z,Be=`Controls: To draw a polygon draw an outline on the canvas holding the left mouse button. To
				draw a circle just place the mouse where you want to create the circle and hold the left
				mouse button. When the radius reaches the desired size just release the mouse button. You
				can also connect two shapes via a hinge. In order to do so, press the &#39;d&#39; button and left
				click on the first shape. This will create a hinge. To connect another shape to it you have
				to draw another shape overlapping the created hinge. To delete a shape press &#39;a&#39; and left
				click it.
				<br/> <br/>

				The physics engine used for the simulation on the right is our toy physics engine written in
				Rust and compiled to WebAssembly. The engine uses two main algorithms to compute the
				collisions. First, the
				<a target="_blank" href="https://en.wikipedia.org/wiki/Gilbert%E2%80%93Johnson%E2%80%93Keerthi_distance_algorithm" class="svelte-5rd8a1">GJK</a>
				algorithm helps determine werther two shapes are in contact. If they are, the
				<a target="_blank" href="https://dyn4j.org/2010/05/epa-expanding-polytope-algorithm/" class="svelte-5rd8a1">EPA</a>
				algorithm picks up at the collision vector, and finds the minimum penetration vector. Based on
				that, an
				<a target="_blank" href="https://en.wikipedia.org/wiki/Collision_response#Impulse-based_contact_model" class="svelte-5rd8a1">impulse</a>
				is calculated, which is then used to apply momentum to the relevant shapes at each time tick.`,Ce,ze;return{c(){e=w("div"),n=w("div"),r=w("div"),i=w("div"),s=w("canvas"),s.innerHTML=f,m=S(),o=w("div"),A=w("span"),G=te("gravity "),q=te(t[0]),U=S(),y=w("input"),$=S(),N=w("div"),N.innerHTML=Q,E=S(),K=w("span"),le=te("friction "),re=te(t[1]),_e=S(),j=w("input"),ue=S(),B=w("div"),B.innerHTML=pe,b=S(),g=w("span"),v=te("restitution "),V=te(t[2]),l=S(),C=w("input"),fe=S(),k=w("div"),k.innerHTML=T,M=S(),P=w("div"),O=w("input"),xe=S(),ie=w("span"),ie.textContent=He,Se=S(),Y=w("div"),X=w("input"),Ie=S(),oe=w("span"),oe.textContent=Ke,je=S(),Z=w("div"),Z.innerHTML=Be,this.h()},l(x){e=p(x,"DIV",{class:!0});var D=W(e);n=p(D,"DIV",{class:!0});var me=W(n);r=p(me,"DIV",{class:!0});var Je=W(r);i=p(Je,"DIV",{class:!0});var Ge=W(i);s=p(Ge,"CANVAS",{class:!0,"data-svelte-h":!0}),ee(s)!=="svelte-qmr5rq"&&(s.innerHTML=f),Ge.forEach(L),Je.forEach(L),m=I(me),o=p(me,"DIV",{class:!0});var h=W(o);A=p(h,"SPAN",{});var De=W(A);G=ne(De,"gravity "),q=ne(De,t[0]),De.forEach(L),U=I(h),y=p(h,"INPUT",{type:!0,min:!0,max:!0,step:!0}),$=I(h),N=p(h,"DIV",{class:!0,"data-svelte-h":!0}),ee(N)!=="svelte-1dhvvbm"&&(N.innerHTML=Q),E=I(h),K=p(h,"SPAN",{class:!0});var Re=W(K);le=ne(Re,"friction "),re=ne(Re,t[1]),Re.forEach(L),_e=I(h),j=p(h,"INPUT",{type:!0,min:!0,max:!0,step:!0}),ue=I(h),B=p(h,"DIV",{class:!0,"data-svelte-h":!0}),ee(B)!=="svelte-f3oit8"&&(B.innerHTML=pe),b=I(h),g=p(h,"SPAN",{class:!0});var Le=W(g);v=ne(Le,"restitution "),V=ne(Le,t[2]),Le.forEach(L),l=I(h),C=p(h,"INPUT",{type:!0,min:!0,max:!0,step:!0}),fe=I(h),k=p(h,"DIV",{class:!0,"data-svelte-h":!0}),ee(k)!=="svelte-1dhvvbm"&&(k.innerHTML=T),M=I(h),P=p(h,"DIV",{class:!0});var ye=W(P);O=p(ye,"INPUT",{type:!0}),xe=I(ye),ie=p(ye,"SPAN",{"data-svelte-h":!0}),ee(ie)!=="svelte-4w3dmm"&&(ie.textContent=He),ye.forEach(L),Se=I(h),Y=p(h,"DIV",{class:!0});var ve=W(Y);X=p(ve,"INPUT",{type:!0}),Ie=I(ve),oe=p(ve,"SPAN",{"data-svelte-h":!0}),ee(oe)!=="svelte-1f9cjqb"&&(oe.textContent=Ke),ve.forEach(L),je=I(h),Z=p(h,"DIV",{class:!0,"data-svelte-h":!0}),ee(Z)!=="svelte-m6rmnj"&&(Z.innerHTML=Be),h.forEach(L),me.forEach(L),D.forEach(L),this.h()},h(){d(s,"class","w-full h-full"),d(i,"class","overflow-hidden aspect-square max-h-full mx-auto border border-gray-400"),d(r,"class","grow-[2] basis-0"),d(y,"type","range"),d(y,"min","-10"),d(y,"max","10"),d(y,"step","0.1"),d(N,"class","flex"),d(K,"class","pt-6"),d(j,"type","range"),d(j,"min","0"),d(j,"max","10"),d(j,"step","0.1"),d(B,"class","flex"),d(g,"class","pt-6"),d(C,"type","range"),d(C,"min","-10"),d(C,"max","10"),d(C,"step","0.1"),d(k,"class","flex"),d(O,"type","checkbox"),d(P,"class","pt-4"),d(X,"type","checkbox"),d(Y,"class","pt-4"),d(Z,"class","mt-4 pt-4 border-t border-gray-400 text-justify"),d(o,"class","grow basis-0 flex flex-col"),d(n,"class","grow min-h-0 flex gap-8"),d(e,"class","h-screen w-screen p-8 flex flex-col")},m(x,D){We(x,e,D),c(e,n),c(n,r),c(r,i),c(i,s),t[13](s),c(n,m),c(n,o),c(o,A),c(A,G),c(A,q),c(o,U),c(o,y),se(y,t[0]),c(o,$),c(o,N),c(o,E),c(o,K),c(K,le),c(K,re),c(o,_e),c(o,j),se(j,t[1]),c(o,ue),c(o,B),c(o,b),c(o,g),c(g,v),c(g,V),c(o,l),c(o,C),se(C,t[2]),c(o,fe),c(o,k),c(o,M),c(o,P),c(P,O),O.checked=t[4],c(P,xe),c(P,ie),c(o,Se),c(o,Y),c(Y,X),X.checked=t[3],c(Y,Ie),c(Y,oe),c(o,je),c(o,Z),Ce||(ze=[R(Ye,"keydown",t[9]),R(Ye,"keyup",t[10]),R(s,"mousedown",t[6]),R(s,"mouseup",t[7]),R(s,"mousemove",t[8]),R(y,"change",t[14]),R(y,"input",t[14]),R(j,"change",t[15]),R(j,"input",t[15]),R(C,"change",t[16]),R(C,"input",t[16]),R(O,"change",t[17]),R(X,"change",t[18])],Ce=!0)},p(x,[D]){D&1&&Ue(q,x[0]),D&1&&se(y,x[0]),D&2&&Ue(re,x[1]),D&2&&se(j,x[1]),D&4&&Ue(V,x[2]),D&4&&se(C,x[2]),D&16&&(O.checked=x[4]),D&8&&(X.checked=x[3])},i:H,o:H,d(x){x&&L(e),t[13](null),Ce=!1,st(ze)}}}function Me(t,e,n){e.forEach(r=>{t.fillStyle=n,t.beginPath(),t.arc(...r,7,0,2*Math.PI),t.fill(),t.stroke()})}function Qe(t){return(+new Date-+t)/20}function Mt(t,e,n){let{PhysicsEngine:r}=e,i,s,f=0;at(()=>{let b=!1;n(12,i=r.create({initial_ball_position:[0,0],circles:[{is_bindable:!1,is_static:!0,shape:{center:[100,900],radius:10}}],flags_positions:[],polygons:[{is_bindable:!1,is_static:!0,shape:[[100,1030],[100,1e3],[1600,1005],[1600,1035]]},{is_bindable:!0,is_static:!0,shape:[[500,600],[500,500],[600,500],[600,600]]}]}));let g=new ResizeObserver(()=>{let V=window.devicePixelRatio,l=s.getBoundingClientRect();n(5,s.width=Math.round(V*l.right)-Math.round(V*l.left),s),n(5,s.height=Math.round(V*l.bottom)-Math.round(V*l.top),s)});g.observe(s);let v=V=>{if(b)return;let l=s.getContext("2d"),{width:C,height:fe}=s,k=i.run_iteration((V-f)*1e3);switch(f=V,l.clearRect(0,0,C,fe),k.polygons.forEach(T=>{let M=T.color;l.fillStyle=`rgb(${Math.floor(M[0]*256)} ${Math.floor(M[1]*256)} ${Math.floor(M[2]*256)})`,l.beginPath();let P=T.shape.vertices[0];l.moveTo(...P),T.shape.vertices.slice(1).forEach(O=>{l.lineTo(...O)}),l.closePath(),l.fill(),l.stroke()}),k.circles.forEach(T=>{let M=T.color;l.fillStyle=`rgb(${Math.floor(M[0]*256)} ${Math.floor(M[1]*256)} ${Math.floor(M[2]*256)})`,l.beginPath(),l.arc(...T.shape.center,T.shape.radius,0,2*Math.PI),l.fill(),l.stroke()}),o.kind){case 0:{l.beginPath(),l.arc(...o.center,Qe(o.startTime),0,2*Math.PI),l.stroke();break}case 1:{l.beginPath();const[T,M]=o.path[0];l.moveTo(T,M);for(const[P,O]of o.path.slice(1))l.lineTo(P,O);l.stroke();break}}k.flags.forEach(T=>{l.fillStyle="black",l.beginPath();let M=T.vertices[0];l.moveTo(...M),T.vertices.slice(1).forEach(P=>{l.lineTo(...P)}),l.closePath(),l.fill(),l.stroke()}),Me(l,k.rigid_bindings,"red"),Me(l,k.unbound_hinges,"orange"),Me(l,k.hinges,"blue"),Me(l,k.unbound_hinges,"green"),requestAnimationFrame(v)};return requestAnimationFrame(v),()=>{i.free(),b=!0,g.disconnect()}});function m(b){let g=s.getBoundingClientRect();return{x:Math.round(b.x*devicePixelRatio)-Math.round(g.left*devicePixelRatio),y:Math.round(b.y*devicePixelRatio)-Math.round(g.top*devicePixelRatio)}}let o={kind:3};function A(b){let{x:g,y:v}=m(b);switch(E){case 0:{i.erase_at(g,v);break}case 1:{i.add_rigid(g,v);break}case 2:{i.add_hinge(g,v);break}case 3:{o={kind:2,circleTriggerTimer:setTimeout(()=>{o={kind:0,center:[g,v],startTime:new Date}},400)};break}}}function G(b){switch(o.kind){case 0:{let g=Qe(o.startTime);i.add_circle(o.center[0],o.center[1],g),o={kind:3};break}case 1:{o.path.length>3&&i.add_polygon({vertices:o.path}),o={kind:3};break}case 2:{clearTimeout(o.circleTriggerTimer),o={kind:3};break}}}function q(b){switch(o.kind){case 0:break;case 1:{let{x:g,y:v}=m(b);o.path.push([g,v]);break}case 2:{clearTimeout(o.circleTriggerTimer);let{x:g,y:v}=m(b);o={kind:1,path:[[g,v]]};break}}}let U=1,y=1,$=1,N=!0,Q=!0,E=3;function K(b){switch(b.code){case"KeyD":{E=2;break}case"KeyA":{E=0;break}case"KeyS":{E=1;break}}}function le(b){switch(b.code){case"KeyD":{E==2&&(E=3);break}case"KeyA":{E==0&&(E=3);break}case"KeyS":{E==1&&(E=3);break}}}function re(b){ct[b?"unshift":"push"](()=>{s=b,n(5,s)})}function _e(){U=Ne(this.value),n(0,U)}function j(){y=Ne(this.value),n(1,y)}function ue(){$=Ne(this.value),n(2,$)}function B(){Q=this.checked,n(4,Q)}function pe(){N=this.checked,n(3,N)}return t.$$set=b=>{"PhysicsEngine"in b&&n(11,r=b.PhysicsEngine)},t.$$.update=()=>{t.$$.dirty&4097&&i?.set_gravity_multipier(U),t.$$.dirty&4098&&i?.set_friction_multipier(y),t.$$.dirty&4100&&i?.set_restitution_multipier($),t.$$.dirty&4104&&i?.set_dynamic_friction(N),t.$$.dirty&4112&&i?.set_static_friction(Q)},[U,y,$,N,Q,s,A,G,q,K,le,r,i,re,_e,j,ue,B,pe]}class At extends Ze{constructor(e){super(),et(this,e,Mt,Tt,Xe,{PhysicsEngine:11})}}function Et(t){return{c:H,l:H,m:H,i:H,o:H,d:H}}function Pt(t){let e,n;return e=new At({props:{PhysicsEngine:Pe}}),{c(){ut(e.$$.fragment)},l(r){ft(e.$$.fragment,r)},m(r,i){dt(e,r,i),n=!0},i(r){n||(qe(e.$$.fragment,r),n=!0)},o(r){Fe(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}function xt(t){let e;return{c(){e=te("Loading")},l(n){e=ne(n,"Loading")},m(n,r){We(n,e,r)},i:H,o:H,d(n){n&&L(e)}}}function St(t){let e,n,r={ctx:t,current:null,token:null,hasCatch:!1,pending:xt,then:Pt,catch:Et,blocks:[,,,]};return ht(nt(),r),{c(){e=$e(),r.block.c()},l(i){e=$e(),r.block.l(i)},m(i,s){We(i,e,s),r.block.m(i,r.anchor=s),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(i,[s]){t=i},i(i){n||(qe(r.block),n=!0)},o(i){for(let s=0;s<3;s+=1){const f=r.blocks[s];Fe(f)}n=!1},d(i){i&&L(e),r.block.d(i),r.token=null,r=null}}}class Ct extends Ze{constructor(e){super(),et(this,e,null,St,Xe,{})}}export{Ct as component};
